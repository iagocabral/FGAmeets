<!DOCTYPE html>
<html>
  <head>
    <title>FGATeams</title>
    <link
      rel="icon"
      href="https://cdn.icon-icons.com/icons2/2248/PNG/512/microsoft_teams_icon_137398.png"
      type="image/x-icon"
    />
    <link rel="stylesheet" type="text/css" href="style.css" media="screen" />
    <!-- Inclui os arquivos de script separados -->
    <script src="chat.js"></script>
    <script src="video.js"></script>
    <script>
      var localStream;
      var localVideo = document.getElementById("localVideo");
      var videoContainer = document.getElementById("videos");

      document.addEventListener("DOMContentLoaded", async () => {
        try {
          const devices = await navigator.mediaDevices.enumerateDevices();
          const videoDevices = devices.filter(
            (device) => device.kind === "videoinput"
          );
          const cameraSelect = document.getElementById("cameraSelect");
          videoDevices.forEach((device) => {
            const option = document.createElement("option");
            option.value = device.deviceId;
            option.text = device.label || `Câmera ${cameraSelect.length + 1}`;
            cameraSelect.appendChild(option);
          });
        } catch (error) {
          console.error("Erro ao listar dispositivos de câmera:", error);
        }
      });
    </script>
  </head>
  <body>
    <div id="telaEscolha" style="display: block">
      <div id="titulo">
        <img
          id="imagemLogo"
          src="https://cdn.discordapp.com/attachments/805795785219506287/1283871787330965595/logo.png?ex=66e49247&is=66e340c7&hm=b8901d75bf0ffa12a3083843160eb961f8a2b8d21d2c5425654f58a61503f49d&"
          alt="Logo"
        />
        <b>Bem-Vindo ao FGATeams</b>
      </div>

      <input type="text" id="nome" name="nome" placeholder="Digite seu nome" />
      <div class="container">
        <button onclick="start()">Começar</button>
      </div>
      <div id="loader" class="loader"></div>
    </div>

    <div id="telaChat" style="display: none">
      <label id="confirmaLabel">Deseja entrar em uma sala existente?</label>
      <div class="container" id="confirma">
        <button class="botao sim" onclick="showSalas()">Sim</button>
        <button class="botao nao" onclick="createSala()">Não</button>
      </div>
      <div id="criaSala" style="display: none">
        <input
          type="text"
          id="nomesala"
          name="nomesala"
          placeholder="Digite o nome da sala que deseja criar"
        />
        <div class="container">
          <button onclick="iniciarConexaoSala()">Criar</button>
        </div>
      </div>
      <div id="telaChats" style="display: none">
        <div id="tituloChat">
          <div>Chat de mensagens</div>
          <div id="containerSalaNome">
            <div>Sala:</div>
            <div id="salaNome"></div>
          </div>
        </div>

        <div id="chat"></div>
        <input type="text" id="mensagem" placeholder="Digite sua mensagem..." />
        <div id="containerBotoesChat">
          <button id="enviar">Enviar</button>
          <button onclick="voltarParaOpcao()">Voltar para Escolha</button>
          <button id="levantarMaoButton" onclick="trocarModoMao()">
            Levantar a Mão
          </button>
        </div>
        <div id="maoIcon" style="display: none">Levantou a mao</div>
        <br />
        <div id="maoIcon1" style="display: none">Levantou a mao</div>
      </div>
      <div id="loader" class="loader"></div>
    </div>

    <div id="telaListaSalas" style="display: none">
      <h1>Escolha a Sala</h1>
      <ul id="listaSalas" class="salas-lista"></ul>
      <div id="loader" class="loader"></div>
    </div>

    <div id="telaVideo" style="display: none">
      <h1>Chat de Vídeo</h1>
      <select id="cameraSelect" onchange="selectCamera()"></select>
      <button onclick="inicializarWebRTC(true)">Iniciar Chamada</button>
      <br />
    </div>
    <div id="chatVideo" style="display: none">
      <button id="muteButton" onclick="changeAudio()">Mutar</button>
      <button id="toggleCameraButton" onclick="changeCamera()">
        Desligar Câmera
      </button>
      <button onclick="shareScreen()">Compartilhar Tela</button>
      <br />
      <video id="localVideo" autoplay muted></video>
      <video id="remoteVideo" autoplay></video>
    </div>
  </body>
</html>
